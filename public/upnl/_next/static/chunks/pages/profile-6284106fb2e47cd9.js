(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[277],{6896:function(e,a,l){(window.__NEXT_P=window.__NEXT_P||[]).push(["/profile",function(){return l(6158)}])},6158:function(e,a,l){"use strict";l.r(a),l.d(a,{__N_SSG:function(){return k},default:function(){return _}});var t=l(4817),s=l(1248),r=l(3590),n=l(2672),i=l(4953),c=l(8735),d=l.n(c),o=l(6229),u=l(7884),x=l(8472),m=l(4878),p=l(2786),h=l(8071),f=l(3648),b=l(2021),w=l(3259),y=e=>{let{currentName:a,currentMail:l,isOpen:r,onClose:n}=e,i=(0,u.m)(),[c,d]=(0,s.useState)(a),[y]=(0,s.useState)(""),v=(0,s.useRef)(null),{updateProfile:g,loading:j}=function(){let[e,a]=(0,s.useState)(!1),{trigger:l,error:t}=(0,m.Z)((0,o.t)(),async function(e,l){let{arg:t}=l;try{a(!0);let l=new FormData;return t.name&&l.append("name",t.name),t.avatar&&l.append("avatar",t.avatar),(await (0,p.Fy)(e,l)).data}catch(e){throw(0,h.C)(e)}finally{a(!1)}},{populateCache:!0,optimisticData:!0});return{updateProfile:l,error:t,loading:e}}(),N=(0,b.I0)();return((0,s.useEffect)(()=>{a&&d(a)},[a]),r)?(0,t.jsx)("div",{className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-50",children:(0,t.jsxs)("div",{className:"bg-white rounded-[20px] w-[400px] px-8 pt-10 pb-6 text-center relative",children:[(0,t.jsx)("h2",{className:"text-lg font-semibold",children:"Edit Profile"}),(0,t.jsx)("div",{className:"w-[100px] my-10 h-[100px] mx-auto cursor-pointer",onClick:()=>{var e;null===(e=v.current)||void 0===e||e.click()},children:y?(0,t.jsx)("img",{src:URL.createObjectURL(y),alt:"User Avatar",className:"rounded-full w-full h-full object-cover"}):(0,t.jsx)("div",{className:"w-full h-full rounded-full mx-auto text-[72px] font-semibold",style:{background:i,fontFamily:"ClashDisplay-Semibold"},children:(0,x.Q)(l)})}),(0,t.jsxs)("div",{className:"mb-4 text-left",children:[(0,t.jsx)("label",{className:"block text-gray-600 mb-1",children:"Name"}),(0,t.jsx)("input",{type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-[12px]",placeholder:"Enter Full Name",value:c,onChange:e=>d(e.target.value)})]}),(0,t.jsxs)("div",{className:"mt-10",children:[(0,t.jsx)("button",{onClick:()=>{g({name:c,avatar:y}).then(()=>{n(),N((0,f.Hs)(!0)),w.Am.success("Profile updated successfully")}).catch(e=>{w.Am.error(e.message)})},className:"w-full h-[46px] mb-2 px-4 py-2 rounded-[30px] bg-black text-white",disabled:j,children:j?"Saving...":"Save"}),(0,t.jsx)("button",{onClick:n,className:"w-full h-[46px] px-4 py-2 rounded-[30px] bg-gray-300",disabled:j,children:"Cancel"})]})]})}):null};let v=()=>{let[e,a]=(0,s.useState)(!1),[l,t]=(0,s.useState)(!1);return{changePassword:async(e,l)=>{a(!0);try{await (0,p.CL)("/meshmain/auth/change-password",{new_password:e,current_password:l}),t(!0)}catch(e){throw(0,h.C)(e)}finally{a(!1)}},loading:e,success:l}};var g=e=>{let{isOpen:a,onClose:l}=e,[r,n]=(0,s.useState)(""),[i,c]=(0,s.useState)(""),[d,o]=(0,s.useState)(""),{changePassword:u,loading:x,success:m}=v(),p=async()=>{if(i!==d){w.Am.error("Passwords do not match");return}try{await u(i,r),w.Am.success("Password changed successfully!")}catch(e){w.Am.error(e.message)}};return((0,s.useEffect)(()=>{m&&l()},[m,l]),a)?(0,t.jsx)("div",{className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-50",children:(0,t.jsxs)("div",{className:"bg-white rounded-[20px] w-[400px] px-8 pt-10 pb-6 text-center relative",children:[(0,t.jsx)("h2",{className:"text-lg font-semibold",children:"Change Password"}),(0,t.jsxs)("div",{className:"mb-4 mt-8 text-left",children:[(0,t.jsx)("label",{className:"block text-gray-600 mb-1",children:"Current Password"}),(0,t.jsx)("input",{type:"password",className:"w-full px-3 py-2 border border-gray-300 rounded-[12px]",placeholder:"Enter Current Password",value:r,onChange:e=>n(e.target.value)})]}),(0,t.jsxs)("div",{className:"mb-4 mt-8 text-left",children:[(0,t.jsx)("label",{className:"block text-gray-600 mb-1",children:"New Password"}),(0,t.jsx)("input",{type:"password",className:"w-full px-3 py-2 border border-gray-300 rounded-[12px]",placeholder:"Enter New Password",value:i,onChange:e=>c(e.target.value)})]}),(0,t.jsxs)("div",{className:"mb-4 mt-4 text-left",children:[(0,t.jsx)("label",{className:"block text-gray-600 mb-1",children:"Repeat New Password"}),(0,t.jsx)("input",{type:"password",className:"w-full px-3 py-2 border border-gray-300 rounded-[12px]",placeholder:"Repeat New Password",value:d,onChange:e=>o(e.target.value)})]}),(0,t.jsxs)("div",{className:"mt-10",children:[(0,t.jsx)("button",{onClick:p,className:"w-full h-[46px] mb-2 px-4 py-2 rounded-[30px] bg-black text-white",disabled:x,children:x?"Changing...":"Confirm"}),(0,t.jsx)("button",{onClick:l,className:"w-full h-[46px] px-4 py-2 rounded-[30px] bg-gray-300",disabled:x,children:"Cancel"})]})]})}):null},j=()=>{let{userProfile:e}=(0,o.G)(),[a,l]=(0,s.useState)(!1),[r,n]=(0,s.useState)(!1);return(0,t.jsxs)("div",{className:"w-full mt-10 flex justify-center text-primary",children:[(0,t.jsx)("div",{className:"max-w-[1920px] w-full",children:(0,t.jsxs)("div",{className:"w-full relative max-w-[669px] pb-[46px] text-center pt-[36px] bg-[#FFF] rounded-[16px] mx-auto mt-[100px]",children:[(null==e?void 0:e.avatar_url)?(0,t.jsx)(d(),{src:(null==e?void 0:e.avatar_url)||"",alt:"User Avatar",width:100,height:100,className:"rounded-full mt-6 mb-2 cursor-pointer mx-auto"}):(0,t.jsx)("div",{className:"w-[100px] h-[100px] rounded-full mx-auto text-[72px] font-semibold",style:{background:(0,u.m)(),fontFamily:"ClashDisplay-Semibold"},children:(0,x.Q)(null==e?void 0:e.email)}),(0,t.jsx)("button",{onClick:()=>l(!0),className:"absolute right-10 top-10",children:(0,t.jsx)(d(),{src:"/assets/icons/pencil.svg",alt:"Edit Icon",width:28,height:28})}),(0,t.jsx)("div",{style:{fontFamily:"ClashDisplay-Semibold"},className:"mx-auto w-full text-primary text-[28px] font-semibold ",children:null==e?void 0:e.name}),(0,t.jsx)("div",{className:"mx-auto w-full text-secondary text-sm mb-[60px]",children:null==e?void 0:e.email}),(0,t.jsx)("div",{className:"flex mx-auto w-full justify-center",children:(0,t.jsx)("button",{onClick:()=>n(!0),className:"rounded-[30px] h-[48px] py-3 px-6 bg-[#F1F1F1] mr-2",children:"Change Password"})})]})}),(0,t.jsx)(y,{currentName:null==e?void 0:e.name,currentMail:null==e?void 0:e.email,isOpen:a,onClose:()=>l(!1)}),(0,t.jsx)(g,{isOpen:r,onClose:()=>n(!1)})]})},N=l(7250);let C=()=>{let e=new r.S({defaultOptions:{queries:{staleTime:1/0}}});return(0,t.jsxs)(n.aH,{client:e,children:[(0,t.jsx)(N.h,{title:"Profile - MeshChain",description:""}),(0,t.jsx)(j,{})]})};C.getLayout=e=>(0,t.jsx)(i.Z,{children:e});var k=!0,_=C}},function(e){e.O(0,[454,962,730,878,953,888,774,179],function(){return e(e.s=6896)}),_N_E=e.O()}]);